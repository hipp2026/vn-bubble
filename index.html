<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>VN30 Bubbles</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<script src="https://cdn.jsdelivr.net/npm/pixi.js@7/dist/pixi.min.js"></script>

<style>
html,body{
  margin:0;
  padding:0;
  background:#0b1220;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,Inter,sans-serif;
}
#ui{
  position:fixed;
  top:12px;
  left:12px;
  background:#0f172a;
  border-radius:14px;
  padding:10px 12px;
  color:#e5e7eb;
  font-size:13px;
  box-shadow:0 10px 30px rgba(0,0,0,.5);
  z-index:10;
}
</style>
</head>
<body>

<div id="ui"><b>VN30</b></div>

<script>
/* ================= PIXI APP ================= */
const app = new PIXI.Application({
  resizeTo: window,
  backgroundColor: 0x0b1220,
  antialias: true,
  autoDensity:true
});
document.body.appendChild(app.view);

/* ================= DATA (VN30 MOCK) ================= */
const VN30 = [
 {s:"VCB",p:98500,c:1.8,v:18,cap:450},
 {s:"BID",p:46200,c:-0.6,v:15,cap:280},
 {s:"CTG",p:33100,c:2.4,v:22,cap:200},
 {s:"FPT",p:141600,c:3.2,v:12,cap:190},
 {s:"HPG",p:28300,c:-1.2,v:30,cap:170},
 {s:"VPB",p:21900,c:1.1,v:25,cap:140},
 {s:"TCB",p:38200,c:0.4,v:20,cap:160},
 {s:"VHM",p:41000,c:-2.1,v:14,cap:220},
 {s:"VNM",p:73800,c:0.2,v:10,cap:180},
 {s:"MWG",p:48700,c:-1.7,v:9,cap:90}
];

/* ================= SCALES ================= */
const rScale = cap => 22 + cap * 0.15;
const colorScale = c =>
  c > 0 ? 0x22c55e :
  c < 0 ? 0xef4444 :
          0x64748b;

/* ================= BUBBLE CLASS ================= */
class Bubble{
  constructor(d){
    this.data = d;
    this.r = rScale(d.cap);
    this.x = Math.random()*app.screen.width;
    this.y = Math.random()*app.screen.height;
    this.vx = (Math.random()-.5)*2;
    this.vy = (Math.random()-.5)*2;
    this.pulse = Math.random()*10;

    this.g = new PIXI.Graphics();
    this.label = new PIXI.Text(d.s,{
      fill:"#ffffff",
      fontSize:14,
      fontWeight:"700"
    });
    this.label.anchor.set(.5);

    app.stage.addChild(this.g,this.label);
  }

  draw(){
    this.g.clear();

    const pulseR = this.r + Math.sin(this.pulse)*2;

    // glow
    this.g.beginFill(colorScale(this.data.c),0.15);
    this.g.drawCircle(0,0,pulseR+6);
    this.g.endFill();

    // core
    this.g.beginFill(colorScale(this.data.c),1);
    this.g.drawCircle(0,0,pulseR);
    this.g.endFill();

    this.g.x=this.x;
    this.g.y=this.y;
    this.label.x=this.x;
    this.label.y=this.y+1;
  }

  step(){
    this.pulse += 0.05 + this.data.v*0.002;

    this.x += this.vx;
    this.y += this.vy;

    // soft bounds
    if(this.x<this.r||this.x>app.screen.width-this.r) this.vx*=-0.9;
    if(this.y<this.r||this.y>app.screen.height-this.r) this.vy*=-0.9;

    // damping
    this.vx *= 0.995;
    this.vy *= 0.995;
  }
}

/* ================= INIT ================= */
const bubbles = VN30.map(d=>new Bubble(d));

/* ================= PHYSICS ================= */
function collide(){
  for(let i=0;i<bubbles.length;i++){
    for(let j=i+1;j<bubbles.length;j++){
      const a=bubbles[i], b=bubbles[j];
      const dx=b.x-a.x, dy=b.y-a.y;
      const dist=Math.hypot(dx,dy);
      const min=a.r+b.r+4;
      if(dist<min){
        const nx=dx/dist, ny=dy/dist;
        const push=(min-dist)*0.02;
        a.vx-=nx*push; a.vy-=ny*push;
        b.vx+=nx*push; b.vy+=ny*push;
      }
    }
  }
}

/* ================= LOOP ================= */
app.ticker.add(()=>{
  collide();
  bubbles.forEach(b=>{
    b.step();
    b.draw();
  });
});
</script>
</body>
</html>
