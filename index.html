<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>D√≤ng ti·ªÅn ch·ª©ng kho√°n VN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Inter,Roboto;
  background:#0b0f1a;
  color:#e5e7eb;
}
header{padding:12px 16px;font-size:18px;font-weight:600;}
.card{background:#111827;border-radius:10px;padding:12px;margin:12px 16px;}
table{width:100%;border-collapse:collapse;}
th,td{padding:8px;font-size:14px;text-align:right;}
th{color:#9ca3af;font-weight:500;}
td:first-child,th:first-child{text-align:left;}
.up{color:#22c55e;}
.down{color:#ef4444;}
.tag{padding:2px 6px;border-radius:6px;font-size:12px;}
.in{background:#052e1b;color:#22c55e;}
.out{background:#3f1d1d;color:#ef4444;}
.loading{color:#9ca3af;font-size:14px;}
</style>
</head>
<body>

<header>üìä D√≤ng ti·ªÅn ch·ª©ng kho√°n Vi·ªát Nam</header>

<div class="card" id="market">ƒêang t·∫£i d·ªØ li·ªáu‚Ä¶</div>

<div class="card">
<b>Top ti·ªÅn v√†o</b>
<table>
<thead><tr><th>M√£</th><th>GTGD</th><th>%</th><th>Ti·ªÅn</th></tr></thead>
<tbody id="in"></tbody>
</table>
</div>

<div class="card">
<b>Top ti·ªÅn ra</b>
<table>
<thead><tr><th>M√£</th><th>GTGD</th><th>%</th><th>Ti·ªÅn</th></tr></thead>
<tbody id="out"></tbody>
</table>
</div>

<script>
// ================= CONFIG =================
// FireAnt public (qua proxy CORS)
const API =
"https://api.allorigins.win/raw?url=https://restv2.fireant.vn/symbols?exchange=HOSE";

// ================= LOGIC =================
function money(v,p){ return v * p; }
function tag(val){
  if(val>0) return '<span class="tag in">V√ÄO</span>';
  if(val<0) return '<span class="tag out">RA</span>';
  return '-';
}

// ================= FETCH =================
fetch(API)
.then(r=>r.json())
.then(data=>{
  // l·∫•y kho·∫£ng 100 m√£ ƒë·∫ßu cho nh·∫π
  const list = data.slice(0,100).map(x=>{
    const value = x.price * x.totalTradingVolume / 1e9; // t·ª∑
    const pct = x.percentChange || 0;
    return {
      s:x.symbol,
      v:Math.round(value),
      p:pct,
      m:money(value,pct)
    };
  });

  const moneyIn = [...list].filter(x=>x.m>0).sort((a,b)=>b.m-a.m).slice(0,10);
  const moneyOut = [...list].filter(x=>x.m<0).sort((a,b)=>a.m-b.m).slice(0,10);

  market.innerHTML = `
    <b>HOSE (Realtime)</b><br>
    S·ªë m√£: ${list.length}<br>
    T·ªïng d√≤ng ti·ªÅn: <b>${Math.round(list.reduce((a,b)=>a+b.m,0))} t·ª∑</b>
  `;

  in.innerHTML = moneyIn.map(x=>`
    <tr>
      <td><b>${x.s}</b></td>
      <td>${x.v}</td>
      <td class="up">+${x.p}%</td>
      <td>${tag(x.m)}</td>
    </tr>
  `).join("");

  out.innerHTML = moneyOut.map(x=>`
    <tr>
      <td><b>${x.s}</b></td>
      <td>${x.v}</td>
      <td class="down">${x.p}%</td>
      <td>${tag(x.m)}</td>
    </tr>
  `).join("");
})
.catch(()=>{
  market.innerHTML = '<span class="loading">Kh√¥ng t·∫£i ƒë∆∞·ª£c d·ªØ li·ªáu (API ch·∫∑n)</span>';
});
</script>

</body>
</html>